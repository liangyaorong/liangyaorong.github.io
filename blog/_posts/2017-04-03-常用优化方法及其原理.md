---
layout: post
title:  "常用优化方法及其原理"
date:   2017-04-03
---
<br>机器学习的各类算法中,常常需要用到最优化算法来求解参数.这篇文章就来总结一下机器学习中常用到的最优化算法.
<br>本文将会提到一下6种最优化算法,偏数理.
* 梯度下降法(gradient descent)
* 牛顿法(Newton's method)
* 拟牛顿法(Quasi-Newton Methods),
1. 包括BFGS
2. L-BFGS
3. DFP
4. Broyden类
5. OWL-QN

## 梯度下降法
<br>梯度下降法最核心的部分在于:"当f(x)在P0点可微时,f(x)在P0的梯度方向是f的值增长最快的方向,且沿该方向方向的变化率就是梯度的模."
<br>(摘自<数学分析>P135 第四版 下册 华东师大)
<br>那么相应的,增长最快的方向就是f(x)在P0的负梯度方向了
<br>下面给出其证明:
1. 方向导数衡量函数在某特定方向l上的变化率,其定义为:
<br>![](http://latex.codecogs.com/gif.latex?f_{l}(P_{0})=\lim_{\rho \rightarrow 0}\frac{f(P)-f(P_{0})}{\rho })
<br>其中P为方向l上一点,rho为P与P0的距离

2. 可以证明(用一阶泰勒展开证),方向导数可表示为梯度与l的方向余弦的内积,即:
<br>![](http://latex.codecogs.com/gif.latex?\begin{align*}
f_{l}(P_{0})&=f_{x_{1}}(P_{0})cos(\alpha )+f_{x_{2}}(P_{0})cos(\beta )+f_{x_{3}}(P_{0})cos(\gamma  )+...\\
&=\triangledown f(P_{0})^{T}\cdot l_{0}\\
&=\left \| \triangledown f(P_{0}) \right \|\cdot \left \| l_{0} \right \|\cdot cos(\theta )
\end{align*}
)
<br>其中,限制l0为l方向上的单位向量,它的模为1; cos(theta)为梯度向量与l0的夹角
<br>这个其实挺容易理解,就是将l方向上的梯度分解到各坐标轴方向.要看详细证明的可以看<数学分析>"方向导数"章节.
<br>注意:要使这个式子成立,有前提: rho趋于0.因为求方向导数本来就是求 rho趋于0 时的极限


3. 可以看到,当theta为0,即l方向为梯度方向时,方向导数取最大值.且为梯度向量的模.
<br>因此,f在P0的梯度方向为f的值增长最快的方向.
<br>显然,这是在欧氏度量意义下才正确.但不在欧氏空间下的梯度一般没什么意义.

<br>下面用两个小例题解释一下什么叫"f(x)沿着梯度方向改变":
* 例一: P0为(1,2),从P0发出一条射线l,l方向为(2,4),求l方向上的点.
<br>解: 显然,答案为
<br>![](http://latex.codecogs.com/gif.latex?P_{0}+\lambda l=
\begin{bmatrix}
1\\ 
2
\end{bmatrix}
+\lambda \begin{bmatrix}
2\\ 
4
\end{bmatrix},\lambda >0)

* 例二: ![](http://latex.codecogs.com/gif.latex?f(\overrightarrow{x})=x_{1}^{2}+x_{2}^{2}),求![](http://latex.codecogs.com/gif.latex?f(\overrightarrow{x}))在![](http://latex.codecogs.com/gif.latex?P_{0}(1,2))处的梯度.
<br>解: ![](http://latex.codecogs.com/gif.latex?\triangledown f(x)=(\frac{\partial f(x)}{\partial x_{1}},\frac{\partial f(x)}{\partial x_{2}})=(2x_{1},2x_{2}) \Rightarrow \triangledown f(P_{0})=(2,4))
<br>即P0处梯度方向是(2,4)
<br>
<br>看到这应该已经非常直白了,f(x)沿着梯度方向改变,就是指其自变量x沿着梯度方向移动.
<br>注意移动的步长要足够小,因为![](http://latex.codecogs.com/gif.latex?\rho \rightarrow 0^{+})
<br>
<br>很自然推出梯度下降算法:
<br>![](http://img.blog.csdn.net/20170404112909737)
<br>

